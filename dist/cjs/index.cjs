"use strict";var e=require("js-sha256");function t(t={},s){if(null==t)return"";const r=function e(t){let s=[];return Object.entries(t).map((([t,r],a)=>{if("object"==typeof r&&null!=r&&null!=r)return s=s.concat(e(r));s.push({key:t,value:r})})),s}(t);if(0==r.length)return null;const a=JSON.stringify(r.sort(((e,t)=>e.key.localeCompare(t.key))));return e.sha256(`${a}|key=${s}`).toUpperCase()}function s({payload:e,key:s,signature:r}){return t(e,s)==r}const r=Object.freeze({REQUEST:"request",HEART_BEAT:"heart-beat",OK:"OK",ERROR:"error"}),a=Object.freeze({POST:"POST",PUT:"PUT",GET:"GET",DELETE:"DELETE",OPTIONS:"OPTIONS",TRACE:"TRACE",PATCH:"PATCH",CONNECT:"CONNECT",HEAD:"HEAD"});const o={error:({version:e="2",errorMsg:t="",message:s,errorStatus:a=null,errorCode:o,statusCode:n=400,type:i=r.ERROR}={})=>({status:"Failed",statusCode:n,version:e,type:i,timestamp:new Date,message:t||s,error:{errorCode:o,status:a,message:s,errorMessage:t||s},payload:null}),success:({version:e="2",message:s="",payload:a=null,statusCode:o=200,type:n=r.REQUEST}={})=>({status:"Succeed",statusCode:o,version:e,type:n,timestamp:new Date,message:s,signature:t(a),payload:a}),ok:()=>o.success({message:"ok",type:r.OK}),heartBeat:()=>o.success({message:"Heart-Beat",type:r.HEART_BEAT})},n={async handle(e){const t=await e.json();if(400==t.statusCode)throw t.error;return t.payload},handleWithCustomErrorCode:async e=>async t=>{const s=await t.json();if(s.statusCode==e)throw s.error;return s.payload}},i={createFetchOptions:({method:e,data:t}={method:a.POST,data:{}})=>({method:e,body:JSON.stringify(t),headers:{"Content-Type":"application/json"}}),put(e={}){return this.createFetchOptions({method:a.PUT,data:e})},post(e={}){return this.createFetchOptions({method:a.POST,data:e})},delete(e={}){return this.createFetchOptions({method:a.DELETE,data:e})}};exports.Fetch=i,exports.FetchResponse=n,exports.HttpMethods=a,exports.HttpResponse=o,exports.HttpResponseType=r,exports.StandardHttpRequest=class{version="1";secretKey=null;constructor({version:e="1",secretKey:t}){this.version=e,this.secretKey=t}request(e){const s=t(e,this.secretKey);return{version:this.version,timestamp:new Date,signature:s,payload:e}}check(e){if(this.isValid(e))return e;throw new Error("[STANDARD-HTTP-REQUEST]: INVALID REQUEST OBJECT WITH SIGNATURE")}parse(e){return this.isValid(e)?e.payload:null}tryParse(e){if(this.isValid(e))return e.payload;throw new Error("[STANDARD-HTTP-REQUEST]: INVALID REQUEST OBJECT WITH SIGNATURE")}isValid(e,t=this.secretKey){return this.#e(e)?this.version==e.version&&s({payload:e.payload,key:this.secretKey,signature:e.signature||t||""}):s({payload:e,key:this.secretKey,signature:t||""})}#e(e){return"object"==typeof e&&null!==e&&"string"==typeof e.version&&e.timestamp instanceof Date&&("string"==typeof e.signature||null===e.signature)&&("object"==typeof e.payload||null===e.payload||void 0!==e.payload)}},exports.StandardHttpResponse=class{version="1";secretKey=null;constructor(e){this.version=e.version,this.secretKey=this.secretKey}error({version:e=this.version,errorMsg:t="",message:s,errorStatus:a=null,errorCode:o,statusCode:n=400,type:i=r.ERROR}={}){return{status:"Failed",statusCode:n,version:e,type:i,timestamp:new Date,message:t||s,error:{errorCode:o,status:a,message:s,errorMessage:t||s},payload:null}}success({version:e=this.version,message:s="",payload:a=null,statusCode:o=200,type:n=r.REQUEST}={}){return{status:"Succeed",statusCode:o,version:e,type:n,timestamp:new Date,message:s,signature:t(a,this.secretKey),payload:a}}ok(){return this.success({message:"ok",type:r.OK})}heartBeat(){return this.success({message:"Heart-Beat",type:r.HEART_BEAT})}},exports.checkSign=s,exports.createSign=t;
//# sourceMappingURL=index.cjs.map
